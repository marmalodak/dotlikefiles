#!/usr/bin/env bash

#echo '$*'=$*

for r in $(rpm -qa) ; do 
    rpminfo=$(rpm -q $r --queryformat '%{NAME}%{DESCRIPTION}')
    echo -n "$rpminfo" | pcregrep -M -q $*
    if [[ $? -eq 0 ]]; then
        echo "$r"
        description=$(rpm -q "$r" --queryformat '%{DESCRIPTION}')
        echo "$description"
        rpm -qi "$r"
        #description=$(ppm -q $r --queryformat 'Name: %{NAME}\r\nCollections: %{COLLECTIONS}\r\nGroup: %{GROUP}\r\nPackager: %{PACKAGER} %{URL}\r\n%{DESCRIPTION}')
    fi
done


# rpm: --querytags:
# ARCH
# ARCHIVESIZE
# BASENAMES
# BUGURL
# BUILDARCHS
# BUILDHOST
# BUILDTIME
# C
# CHANGELOGNAME
# CHANGELOGTEXT
# CHANGELOGTIME
# CLASSDICT
# COLLECTIONS
# CONFLICTFLAGS
# CONFLICTNAME
# CONFLICTS
# CONFLICTVERSION
# COOKIE
# DBINSTANCE
# DEPENDSDICT
# DESCRIPTION
# DIRINDEXES
# DIRNAMES
# DISTRIBUTION
# DISTTAG
# DISTURL
# DSAHEADER
# E
# EPOCH
# EPOCHNUM
# EVR
# EXCLUDEARCH
# EXCLUDEOS
# EXCLUSIVEARCH
# EXCLUSIVEOS
# FILECAPS
# FILECLASS
# FILECOLORS
# FILECONTEXTS
# FILEDEPENDSN
# FILEDEPENDSX
# FILEDEVICES
# FILEDIGESTALGO
# FILEDIGESTS
# FILEFLAGS
# FILEGROUPNAME
# FILEINODES
# FILELANGS
# FILELINKTOS
# FILEMD5S
# FILEMODES
# FILEMTIMES
# FILENAMES
# FILEPROVIDE
# FILERDEVS
# FILEREQUIRE
# FILESIZES
# FILESTATES
# FILEUSERNAME
# FILEVERIFYFLAGS
# FSCONTEXTS
# GIF
# GROUP
# HDRID
# HEADERCOLOR
# HEADERI18NTABLE
# HEADERIMAGE
# HEADERIMMUTABLE
# HEADERREGIONS
# HEADERSIGNATURES
# ICON
# INSTALLCOLOR
# INSTALLTID
# INSTALLTIME
# INSTPREFIXES
# LICENSE
# LONGARCHIVESIZE
# LONGFILESIZES
# LONGSIGSIZE
# LONGSIZE
# N
# NAME
# NEVR
# NEVRA
# NOPATCH
# NOSOURCE
# NVR
# NVRA
# O
# OBSOLETEFLAGS
# OBSOLETENAME
# OBSOLETES
# OBSOLETEVERSION
# OLDFILENAMES
# OPTFLAGS
# ORDERFLAGS
# ORDERNAME
# ORDERVERSION
# ORIGBASENAMES
# ORIGDIRINDEXES
# ORIGDIRNAMES
# ORIGFILENAMES
# OS
# P
# PACKAGER
# PATCH
# PATCHESFLAGS
# PATCHESNAME
# PATCHESVERSION
# PAYLOADCOMPRESSOR
# PAYLOADFLAGS
# PAYLOADFORMAT
# PKGID
# PLATFORM
# POLICIES
# POLICYFLAGS
# POLICYNAMES
# POLICYTYPES
# POLICYTYPESINDEXES
# POSTIN
# POSTINFLAGS
# POSTINPROG
# POSTTRANS
# POSTTRANSFLAGS
# POSTTRANSPROG
# POSTUN
# POSTUNFLAGS
# POSTUNPROG
# PREFIXES
# PREIN
# PREINFLAGS
# PREINPROG
# PRETRANS
# PRETRANSFLAGS
# PRETRANSPROG
# PREUN
# PREUNFLAGS
# PREUNPROG
# PROVIDEFLAGS
# PROVIDENAME
# PROVIDES
# PROVIDEVERSION
# PUBKEYS
# R
# RECONTEXTS
# RELEASE
# REMOVETID
# REQUIREFLAGS
# REQUIRENAME
# REQUIRES
# REQUIREVERSION
# RPMVERSION
# RSAHEADER
# SHA1HEADER
# SIGGPG
# SIGMD5
# SIGPGP
# SIGSIZE
# SIZE
# SOURCE
# SOURCEPACKAGE
# SOURCEPKGID
# SOURCERPM
# SUMMARY
# TRIGGERCONDS
# TRIGGERFLAGS
# TRIGGERINDEX
# TRIGGERNAME
# TRIGGERSCRIPTFLAGS
# TRIGGERSCRIPTPROG
# TRIGGERSCRIPTS
# TRIGGERTYPE
# TRIGGERVERSION
# URL
# V
# VCS
# VENDOR
# VERBOSE
# VERIFYSCRIPT
# VERIFYSCRIPTFLAGS
# VERIFYSCRIPTPROG
# VERSION
# XPM
